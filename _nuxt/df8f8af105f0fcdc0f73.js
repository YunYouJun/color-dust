(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{326:function(t,e,r){"use strict";r.d(e,"d",(function(){return n})),r.d(e,"a",(function(){return o})),r.d(e,"c",(function(){return h})),r.d(e,"b",(function(){return c}));r(16),r(17),r(4);function n(t,g,b){t/=255,g/=255,b/=255;var e,s,r=Math.max(t,g,b),n=Math.min(t,g,b),o=(r+n)/2;if(r===n)e=s=0;else{var h=r-n;switch(s=o>.5?h/(2-r-n):h/(r+n),r){case t:e=(g-b)/h+(g<b?6:0);break;case g:e=(b-t)/h+2;break;case b:e=(t-g)/h+4}e*=60}return[e,100*s,100*o]}function o(t,s,e){var r,g,b;if(t/=360,e/=100,0===(s/=100))r=g=b=e;else{var n=function(p,q,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p},q=e<.5?e*(1+s):e+s-e*s,p=2*e-q;r=n(p,q,t+1/3),g=n(p,q,t),b=n(p,q,t-1/3)}return[Math.round(255*r),Math.round(255*g),Math.round(255*b)]}function h(t){if(t){var e="#",r=[];if(Array.isArray(t)&&3===t.length)r=t.slice();else{if(!("r"in t&&"g"in t&&"b"in t))return"";r=[t.r,t.g,t.b]}for(var i=0;i<r.length;i++){var n=r[i].toString(16);e+=n.length<2?"0"+n:n}return e}}function c(t){var e;return.299*(t=(e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t))?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null).r+.578*t.g+.114*t.b<=192}},332:function(t,e,r){"use strict";r.d(e,"a",(function(){return l}));r(67);var n=r(26),o=(r(4),r(22)),h=r(38),c=r(326),l=function(){function t(canvas,e){Object(o.a)(this,t),this.canvas=canvas,this.ctx=this.canvas.getContext("2d"),this.pixelRatio=window.devicePixelRatio||1,this.canvas.width=this.pixelRatio*parseInt(getComputedStyle(this.canvas).width),this.canvas.height=this.pixelRatio*parseInt(getComputedStyle(this.canvas).height),this.oriWidth=this.canvas.width,this.oriHeight=this.canvas.height,this.colorsInfo=[],this.processInfo={colors:0,censusTime:0,kmeansIteration:0,kmeansTime:0,top5Count:0},this.mainColor=[],this.averageColor=[],this.clusterRes={},this.score="",this.K=e||6}return Object(h.a)(t,[{key:"readFile",value:function(t){var e=this;if(t instanceof File){var r=new FileReader;return r.readAsDataURL(t),new Promise((function(t){r.onload=function(){var r=Object(n.a)(regeneratorRuntime.mark((function r(n){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.drawToCanvas(n.target.result);case 2:e.censusImage(),t();case 4:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}()}))}var o=new XMLHttpRequest;return new Promise((function(r){o.onload=function(){var o=Object(n.a)(regeneratorRuntime.mark((function n(o){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=URL.createObjectURL(o.target.response),n.next=3,e.drawToCanvas(t);case 3:e.censusImage(),r();case 5:case"end":return n.stop()}}),n)})));return function(t){return o.apply(this,arguments)}}(),o.open("GET",t,!0),o.responseType="blob",o.send()}))}},{key:"drawToCanvas",value:function(t){var e=this,r=this.pixelRatio,canvas=this.canvas,n=this.ctx,img=new Image;return img.src=t,img.crossOrigin="anonymous",new Promise((function(t){img.onload=function(){n.clearRect(0,0,canvas.width,canvas.height);var o=0,h=0;img.width<img.height?(o=100*r,e.isHorizontal=!1):(h=100*r,e.isHorizontal=!0);var c=img.width>(canvas.width-o)/r?(canvas.width-o)/r:img.width,l=img.height>(canvas.height-h)/r?(canvas.height-h)/r:img.height,f=c/img.width<l/img.height?c/img.width:l/img.height;c=img.width*f,l=img.height*f,canvas.style.width=c+o/r+"px",canvas.style.height=l+h/r+"px",canvas.width=c*r+o,canvas.height=l*r+h,n.drawImage(img,0,0,img.width,img.height,0,0,c*r,l*r),t()}}))}},{key:"censusImage",value:function(){var canvas=this.canvas,t=this.ctx,e=this.pixelRatio,r=(new Date).getTime(),n=null;if(!(n=this.isHorizontal?t.getImageData(0,0,canvas.width,canvas.height-100*e):t.getImageData(0,0,canvas.width-100*e,canvas.height)))return"Can not read image data, maybe because of cross-domain limitation.";var o,g,b,h=[],l=0,f=n.height*n.width<36e4?1:2,d=Math.round(.1066*this.K*this.K-2.7463*this.K+17.2795);d=d<4?4:d;var v={colors:0,censusTime:0,kmeansIteration:0,kmeansTime:0,top5Count:0};v.colorStep=d;for(var m,C,w=[],y=1;y<n.height-1;){for(var col=1;col<n.width-1;)if(o=n.data[y*n.width*4+4*col],g=n.data[y*n.width*4+4*col+1],b=n.data[y*n.width*4+4*col+2],(m=Object(c.d)(o,g,b))[2]>97||m[2]>95&&m[1]<30)col+=f;else if(m[2]<3||m[2]<5&&m[1]<30)col+=f;else{l++,C=1e4*Math.floor(m[0]/10)+100*Math.floor(m[1]/5)+Math.floor(m[2]/5);var k=h.indexOf(C);k<0?(h.push(C),w.push({key:C,fre:1,r:o,g:g,b:b,h:m[0],s:m[1],l:m[2],category:-1})):w[k].fre++,col+=f}y+=f}v.pixelCount=l,v.censusTime=(new Date).getTime()-r,v.colors=w.length,r=(new Date).getTime(),w.sort((function(pre,t){return t.fre-pre.fre}));var x=w.length;w=w.filter((function(t){return!(t.fre<5-f&&x>400)})),this.mainColor=[Object(c.c)(w[0]),Object(c.c)(w[1]),Object(c.c)(w[2])];var R=this.chooseSeedColors(w,this.K);this.clusterRes=this.kMC(w,R,100),this.clusterColors=this.clusterRes.seeds,this.clusterColors=this.clusterColors.map((function(t){return Object(c.c)(Object(c.a)(t.h,t.s,t.l))}));var M=0,I=0,j=0,O=0;for(x=w.length;x--;)M+=w[x].r*w[x].fre,I+=w[x].g*w[x].fre,j+=w[x].b*w[x].fre,O+=w[x].fre;this.averageColor=Object(c.c)({r:Math.floor(M/O),g:Math.floor(I/O),b:Math.floor(j/O)}),v.kmeansTime=+new Date-r,v.kmeansIteration=this.clusterRes.iteration,this.info=this.countColor(w),v.top5Count=100*this.info.top5Count,this.colorsInfo=w,this.processInfo=v}},{key:"chooseSeedColors",value:function(t,e){for(var r=[],n=t.length,i=0;i<n;i++){var o=r.length,h=t[i];if(i){for(var c=0;c<o;c++){if(Math.abs(r[c].h-h.h)+Math.abs(r[c].s-h.s)+Math.abs(r[c].l-h.l)<45)break}if(c===o&&(h.category=r.length,r.push({h:h.h,s:h.s,l:h.l,category:h.category,fre:h.fre})),r.length>=e)break}else h.category=0,r.push({h:h.h,s:h.s,l:h.l,category:h.category,fre:h.fre})}return r}},{key:"kMC",value:function(t,e,r){for(var n=0;n++<r;){e=e.filter((function(t){return t}));for(var o=t.length,h=o/8^0,l=o%8;l--;)this.classifyColor(t[l],e);for(;h--;)this.classifyColor(t[--o],e),this.classifyColor(t[--o],e),this.classifyColor(t[--o],e),this.classifyColor(t[--o],e),this.classifyColor(t[--o],e),this.classifyColor(t[--o],e),this.classifyColor(t[--o],e),this.classifyColor(t[--o],e);o=t.length;for(var f=[],d=void 0;o--;)f[d=t[o].category]?f[d].freCount+=t[o].fre:(f[d]={},f[d].h=0,f[d].s=0,f[d].l=0,f[d].freCount=t[o].fre);for(o=t.length;o--;)f[d=t[o].category].h+=t[o].h*t[o].fre/f[d].freCount,f[d].s+=t[o].s*t[o].fre/f[d].freCount,f[d].l+=t[o].l*t[o].fre/f[d].freCount;var v=f.every((function(t,r){return Math.abs(t.h-e[r].h)<.5&&Math.abs(t.s-e[r].s)<.5&&Math.abs(t.l-e[r].l)<.5}));if(e=f.map((function(t,e){return{h:t.h,s:t.s,l:t.l,category:e,fre:t.freCount}})),v)break}return e.sort((function(pre,t){var e=Object(c.a)(pre.h,pre.s,pre.l);e=e[0]+e[1]+e[2];var r=Object(c.a)(t.h,t.s,t.l);return(r=r[0]+r[1]+r[2])-e})),{seeds:e,iteration:n}}},{key:"classifyColor",value:function(t,e){for(var r,n=e.length,o=1e4;n--;){var h=Math.abs(e[n].h-t.h)+Math.abs(e[n].s-t.s)+Math.abs(e[n].l-t.l);h<o&&(o=h,r=n)}t.category=r}},{key:"countColor",value:function(t){for(var e,r={top50Count:0,top20Count:0,top10Count:0,top5Count:0},n=0,o=0,h=0,c=0,l=0,f=t.length;f--;)n+=(e=t[f]).fre,f<50&&(o+=e.fre,f<20&&(h+=e.fre,f<10&&(c+=e.fre,f<5&&(l+=e.fre))));return f=t.length,r.top50Count=o/n,r.top20Count=h/n,r.top10Count=c/n,r.top5Count=l/n,r}},{key:"drawPalette",value:function(){var t=this.pixelRatio,canvas=this.canvas,e=this.ctx,r=this.isHorizontal?canvas.width:canvas.height,n=r*(this.K<10?.02:.01),p=(r-(this.K-1)*n)/this.K,o=this.clusterColors;if(0!==o.length){this.isHorizontal?e.clearRect(0,canvas.height-90*t,canvas.width,90*t):e.clearRect(canvas.width-90*t,0,90*t,canvas.height);for(var i=0;i<this.K;i++)e.fillStyle=o[i],this.isHorizontal?e.fillRect((p+n)*i,canvas.height-90*t,p,90*t):e.fillRect(canvas.width-90*t,(p+n)*i,90*t,p)}}},{key:"clearCanvas",value:function(){this.canvas.width=this.oriWidth,this.canvas.height=this.oriHeight}}]),t}()},333:function(t,e,r){var content=r(353);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(12).default)("70a1b3a4",content,!0,{sourceMap:!1})},352:function(t,e,r){"use strict";var n=r(333);r.n(n).a},353:function(t,e,r){(e=r(11)(!1)).push([t.i,".album-canvas{position:fixed;opacity:0;z-index:-1;width:300;height:300}",""]),t.exports=e},398:function(t,e,r){"use strict";r.r(e);r(67);var n=r(26),o=r(332),h=r(326),c={mounted:function(){this.colorDust=new o.a(this.$refs.albumDemo)},methods:{handleCardClick:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var img,n,o,c,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(img=t.target.previousElementSibling.style.backgroundImage){r.next=3;break}return r.abrupt("return");case 3:return n=img.slice(5,-2),r.next=6,e.colorDust.readFile(n);case 6:o=e.colorDust.mainColor,c=e.colorDust.averageColor,l=o[0],e.$vuetify.theme.dark=Object(h.b)(l),e.$store.commit("theme/setPrimaryColor",c),e.$store.commit("theme/setAccentColor",l);case 12:case"end":return r.stop()}}),r)})))()}},head:function(){return{title:"Image Test"}}},l=(r(352),r(41)),f=r(50),d=r.n(f),v=r(388),m=r(133),C=r(354),w=r(117),y=r(132),k=r(355),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-row",[r("v-col",{attrs:{cols:"12"}},[r("v-row",[t._l(8,(function(e){return r("v-col",{key:e,attrs:{cols:"6",md:"3"}},[r("v-card",{staticClass:"d-flex",on:{click:t.handleCardClick}},[r("v-img",{staticClass:"grey lighten-2",attrs:{src:"https://i.picsum.photos/id/"+e+"00/200/200.jpg","aspect-ratio":"1"},scopedSlots:t._u([{key:"placeholder",fn:function(){return[r("v-row",{staticClass:"fill-height ma-0",attrs:{align:"center",justify:"center"}},[r("v-progress-circular",{attrs:{indeterminate:"",color:"grey lighten-5"}})],1)]},proxy:!0}],null,!0)})],1)],1)})),t._v(" "),r("v-col",{attrs:{cols:"12"}},[r("v-alert",{attrs:{border:"left","colored-border":"",elevation:"2"}},[r("p",{staticClass:"ml-2 my-0 headline font-weight-light"},[t._v("\n            You can click the card to switch to a theme similar to the\n            picture. "),r("br"),t._v("Just need some time to load image.\n          ")]),t._v(" "),r("canvas",{ref:"albumDemo",staticClass:"album-canvas"})])],1)],2)],1)],1)}),[],!1,null,null,null);e.default=component.exports;d()(component,{VAlert:v.a,VCard:m.a,VCol:C.a,VImg:w.a,VProgressCircular:y.a,VRow:k.a})}}]);